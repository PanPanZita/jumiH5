define(["jumi","nav","slidefocus","scrolltotop","asyncload","weixin","vue","isLogin","isLoginwx","appSpread","numberboard","getPara","md5"],function(e,t,i,n,o,a,r,s,l,c,u,d,p){var m=d.get();if(m.from)var f=location.href.split("&code=")[1];else var f=location.href.split("?code=")[1];var h=localStorage.getItem("token"),g={bannerNumber:5,noticeNumber:5,repaymentItemNumber:2,successItemNumber:2,stickItemNumber:999,token:h,requestSource:"WAP"};$.ajax({url:"/homePage/getHomePageInfo",type:"post",dataType:"json",data:g,success:function(n){"0000"===n.code?new r({el:"body",components:{"my-index":{template:"#indexTemplate",data:function(){return{data:n,imgs:n.data.bannerList,notices:n.data.noticeList,lists:n.data.stickItemList,successItemList:n.data.successItemList,repaymentItemList:n.data.repaymentItemList,userpwdreal:"",userconfirmpwdreal:""}},computed:{noticesNew:function(){for(var e=this,t=0;t<e.notices.length;t++){var i=e.notices[t].id;0==e.notices[t].type?e.notices[t].linkUrl="/h5/views/notice/announcement.html?inforId="+i:1==e.notices[t].type?e.notices[t].linkUrl="/h5/views/notice/projectDynamics.html?inforId="+i:2==e.notices[t].type&&(1==e.notices[t].mediaType?e.notices[t].linkUrl="/h5/views/notice/mediaReport.html?inforId="+i:2==e.notices[t].mediaType&&(e.notices[t].linkUrl=e.notices[t].linkUrl))}return e.notices}},methods:{jumpinvest:function(e,t){f||(s(function(){location.href="/h5/views/invest/invest.html?itemId="+e}),t.preventDefault())},successjump:function(e,t){f||(s(function(){location.href="/h5/views/invest/invest.html?itemId="+e}),t.preventDefault())},repaymentjump:function(e,t){f||(s(function(){location.href="/h5/views/invest/invest.html?itemId="+e}),t.preventDefault())},toInvite:function(){f||s(function(){location.href="/h5/views/account/invite/invite.html"})},noticesMore:function(){location.href="/h5/views/notice/information.html"},highlight:function(){var e=/^\S{0}$/,t=1==$("#userpwdreal").attr("proving")?1:0,i=1==$("#userconfirmpwdreal").attr("proving")?1:0,n=!e.test(this.userpwdreal)&&!e.test(this.userconfirmpwdreal),o=t&&i;n&&o?($(".ui-dialog-upgrade .ui-dialog-footer button.ui-dialog-autofocus").removeAttr("disabled","disabled"),$(".ui-dialog-upgrade .ui-dialog-footer button.ui-dialog-autofocus").css({color:"#ec6121"})):($(".ui-dialog-upgrade .ui-dialog-footer button.ui-dialog-autofocus").attr("disabled","disabled"),$(".ui-dialog-upgrade .ui-dialog-footer button.ui-dialog-autofocus").css({color:"#999"}))},userpwdrealKeyup:function(){var t=/^[0-9]*$/;return t.test(this.userpwdreal)?(6==this.userpwdreal.length?$("#userpwdreal").attr("proving",1):$("#userpwdreal").attr("proving",0),void this.highlight()):($("#userpwdreal").attr("proving",0),e.tips("支付密码格式错误！"),void(this.userpwdreal=""))},userconfirmpwdrealKeyup:function(){var t=this.userconfirmpwdreal.length;6==t?this.userconfirmpwdreal==this.userpwdreal?$("#userconfirmpwdreal").attr("proving",1):($("#userconfirmpwdreal").attr("proving",0),e.tips("两次设置的支付密码不一致！")):$("#userconfirmpwdreal").attr("proving",0),this.highlight()}},filters:{tenthousand:function(e){return e>=1e4?e/1e4+"万":e+"元"},reachrate:function(e){return e.toFixed(2)},cycleStr:function(e){var t="";return"1"==e?t="日":"2"==e?t="周":"3"==e?t="个月":"4"==e?t="季":"5"==e&&(t="年"),t}}}},ready:function(){var n=this;t.setActiveNav("index"),i.init({id:"#slider"}),i.init({id:"#sliderNotice",width:"100%",height:"30%"}),$(".async").asyncload(),$("#myloading").remove(),u.init("userpwdreal"),u.init("userconfirmpwdreal"),"ios"!=localStorage.fromapp&&"android"!=localStorage.fromapp&&c.init();var o=0;if(o=setInterval(function(){var e=$("#notices li:first"),t=$("#notices li").eq(1),i=$("#notices li:last");e.animate({opacity:0},1e3,function(){e.insertAfter(i),t.animate({opacity:1},1e3)})},5e3),f){var r=f.split("&state=")[0];l(r,"/h5/views/main/index.html")}a.setTitle().setDesc().setImg().setUrl().share(),$(".information li").each(function(e,t){var i=$(this).find(".inforTitle").html(),n=$(this).find(".inforTitle").html().length;n>14&&$(this).find(".inforTitle").html(i.substring(0,14)+"...");var o=$(this).find(".inforCon").html(),a=o.split("<br>",1).toString(),r=a.length;r>40?$(this).find(".inforCon").html(a.substring(0,40)+"..."):$(this).find(".inforCon").html(a)});var s={token:h,requestSource:"WAP"};$.ajax({url:"/common/getResetPayPasswordIndex",type:"post",datatype:"json",data:s,success:function(t){"0000"==t.code&&1==t.data.isLogin&&0==t.data.hasChangePaypassword&&e.alert({title:"",content:'<div class="textcenter"><p>尊敬的用户：</p><p>聚米众筹进行了4.0账户安全升级，</p><p>请完成账户升级操作</p></div>',button:[{value:"立即前往",callback:function(){$("#realname").html(t.data.realname),$("#idNumber").html(t.data.idNumber),e.alert({title:"",skin:"ui-dialog-upgrade",content:document.getElementById("upgradeWrap"),button:[{value:"立即修改",callback:function(){var i={password:p(n.$children[0].userpwdreal).toLocaleUpperCase(),newPassword:p(n.$children[0].userpwdreal).toLocaleUpperCase(),confirmPassword:p(n.$children[0].userconfirmpwdreal).toLocaleUpperCase(),pwdType:"paypassword",token:h,requestSource:"WAP"};$.ajax({url:"/userCenter/setting/resetPayPassword",type:"post",datatype:"json",data:i,success:function(){"0000"==t.code?e.alert({title:"",skin:"ui-dialog-upsuccess",content:document.getElementById("upsuccess"),button:[{value:"完成",callback:function(){}}]}):e.tips(t.msg)}})}}]}),$(".ui-dialog .ui-dialog-footer button.ui-dialog-autofocus").attr("disabled","disabled")}}]})}})}}):e.tips(n.msg)}})});