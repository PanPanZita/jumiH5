define(["jumi","nav","asyncload","weixin","isLogin","isLoginwx","getPara","vue"],function(e,t,a,i,n,r,o,s){var d=localStorage.getItem("token"),l={token:d,requestSource:"WAP"},c={activityId:1,token:d,requestSource:"WAP"},u=o.get();if(u.from)var w=location.href.split("&code=")[1];else var w=location.href.split("?code=")[1];$.ajax({url:"/activity/getTurnTableIndex",type:"post",dataType:"json",data:l,success:function(a){"0000"==a.code&&new s({el:"body",components:{"my-wheel":{template:"#wheelTemplate",data:function(){return{data:a.data,awardList:a.data.jmAwardList,freetimes:a.data.freeTimes,neverClickbtn:!0,isRun:!1,current:0,setRotating:null,speed:200,diffAdd:30,diffSub:10,award:{},time:0}},methods:{toLogin:function(){w||n()},viewshistory:function(){w||n(function(){location.href="/h5/views/wheel/wheelRecord.html"})},start:function(){var e=this;e.isRun||n(function(){e.rollResult(),e.time=Date.now(),e.speed=200,e.diffAdd=30,e.diffSub=10,e.isRun=!0,e.neverClickbtn=!1,$(".wheel-start").find("img").attr("src","/h5/images/wheel/origin/wheel-end.png")})},rollResult:function(){var t=this;$.ajax({type:"post",url:"/needLogin/activity/checkDraw",dataType:"json",data:c,success:function(a){return"0000"!=a.code?void e.tips(a.msg):(t.freetimes=a.data.freetimes,t.award.sort=a.data.sort,t.award.awardName=a.data.awardName,t.roll(),void 0)}})},roll:function(){var t=this,a=t.award.sort-1;t.setRotating=setTimeout(function(){if(t.current++,t.current>7&&(t.current=0),t.award.sort&&(Date.now()-t.time)/1e3>2){if(t.speed+=t.diffAdd,(Date.now()-t.time)/1e3>4&&t.award.sort==t.awardList[t.current].sort)return clearTimeout(t.setRotating),setTimeout(function(){$(".award"+a).animate({padding:"2vw"}),e.alert({content:"恭喜！ 您成功抽取了"+t.award.awardName,button:[{value:"知道了",callback:function(){t.isRun=!1,$(".wheel-start").find("img").attr("src","/h5/images/wheel/origin/wheel-start.png")}}]})},0),void setTimeout(function(){t.isRun=!1,$(".award"+a).animate({padding:"1vw"}),$(".wheel-start").find("img").attr("src","/h5/images/wheel/origin/wheel-start.png")},200)}else t.speed-=t.diffSub;t.roll()},t.speed)}}}},ready:function(){if(w){var e=w.split("&state=")[0];r(e,"/h5/views/wheel/wheel.html")}t.setActiveNav("discover"),$(".async").asyncload(),$("#myloading").remove(),i.setTitle("聚米众筹天天转盘，富力转不停").setDesc().setImg().setUrl(location.origin+"/h5/views/wheel/wheel.html").share()}})}})});