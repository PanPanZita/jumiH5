define(["jumi","weixin","getPara","isLogin","isLoginwx","vue"],function(t,a,e,i,c,n){var r=e.get(),o=localStorage.getItem("token"),d=r.preType?r.preType:0,l={preType:d,token:o,activityId:r.action_id,requestSource:"WAP"};$.ajax({url:"/activity/getActivityDetailById",type:"post",dataType:"json",data:l,success:function(e){"0000"==e.code&&new n({el:"body",components:{"my-detail":{template:"#detailTemplate",data:function(){return{data:e.data,exchangeStr1:'<div class="textcenter">聚小米提醒您，兑换成功！</div>',exchangeStr2:'<div class="textcenter"><p>聚小米提醒您，兑换成功！</p><p class="clr-gray">订单将在3个工作日内处理完毕！</p></div>',exchangeStr3:'<div class="textcenter"><p>聚小米提醒您，兑换成功！</p><p class="clr-gray">订单将在3个工作日内处理完毕！</p></div>',lotteryStr1:'<div class="textcenter">聚小米提醒您，抽奖成功！</div>',lotteryStr2:'<div class="textcenter"><p>聚小米提醒您，抽奖成功！</p><p class="clr-gray">订单将在3个工作日内处理完毕！</p></div>',lotteryStr3:'<div class="textcenter"><p>聚小米提醒您，抽奖成功！</p><p class="clr-gray">订单将在3个工作日内处理完毕！</p></div>',lotteryStr4:'<div class="textcenter"><p>聚小米提醒您，您没有中奖~</div>',isIOSShow:"ios"==localStorage.fromapp}},methods:{next:function(){var a=this;i(function(){var e={token:o,activityId:r.action_id,requestSource:"WAP"};$.ajax({url:"/needLogin/activity/checkDraw",type:"post",dataType:"json",data:e,success:function(e){3==a.data.type&&("0000"==e.code?(a.data.useCoin=a.data.useCoin-a.data.expendCoin,a.data.remainingNumber-=1,4==e.data.awardType&&t.alert({title:"兑换",content:a.exchangeStr3,button:[{value:"维护订单",callback:function(){location.href="/h5/views/account/active/activeDetail.html?orderId="+e.data.orderid}}]}),3==e.data.awardType&&t.alert({title:"兑换",content:a.exchangeStr2,button:[{value:"确认订单",callback:function(){location.href="/h5/views/account/active/activeDetail.html?orderId="+e.data.orderid}}]}),0!=e.data.awardType&&1!=e.data.awardType&&2!=e.data.awardType||t.alert({title:"兑换",content:a.exchangeStr1,button:[{value:"查看记录",callback:function(){location.href="/h5/views/account/active/activeRecord.html"}}]})):t.tips(e.msg)),2==a.data.type&&("0000"==e.code?(a.data.useCoin=a.data.useCoin-a.data.expendCoin,4==e.data.awardType&&(a.data.remainingNumber-=1,t.alert({title:"抽奖",content:a.lotteryStr3,button:[{value:"维护订单",callback:function(){location.href="/h5/views/account/active/activeDetail.html?orderId="+e.data.orderid}}]})),3==e.data.awardType&&(a.data.remainingNumber-=1,t.alert({title:"抽奖",content:a.lotteryStr2,button:[{value:"确认订单",callback:function(){location.href="/h5/views/account/active/activeDetail.html?orderId="+e.data.orderid}}]})),0!=e.data.awardType&&1!=e.data.awardType&&2!=e.data.awardType||(a.data.remainingNumber-=1,t.alert({title:"抽奖",content:a.lotteryStr1,button:[{value:"查看记录",callback:function(){location.href="/h5/views/account/active/activeRecord.html"}}]})),e.data.awardType==-1&&t.alert({title:"抽奖",content:a.lotteryStr4,button:[{value:"知道了",callback:function(){location.reload()}}]})):t.tips(e.msg))}})})}}}},ready:function(){$("#myloading").remove();var t=this,e=t.$children[0].data.name,i=location.href.split("&code=")[0],n=location.href.split("&code=")[1];if(n){var o=n.split("&state=")[0];c(o,i)}a.setTitle(e).setDesc().setImg().setUrl(location.origin+"/h5/views/topic/topicDetail.html?action_id="+r.action_id).share()}})}})});