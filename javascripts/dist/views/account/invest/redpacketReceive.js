define(["jumi","vue","getPara","weixin"],function(e,a,t,i){var d=t.get(),s={investBillIdCode:d.param,code:d.code,requestSource:"WAP"};$.ajax({url:"/weixin/initRedPacketPageDate",type:"post",dataType:"json",data:s,success:function(t){"0000"==t.code&&(t.data.returnUrl?location.href=t.data.returnUrl:new a({el:"body",components:{"my-redpacket":{template:"#redpacketTemplate",data:function(){return{data:t.data,userphone:"",receiveUserList:t.data.receiveUserList,recommendPicList:t.data.recommendPicList,logoList:t.data.logoList,modifyPhone:"",hasReceive:t.data.hasReceive,hasReceiveOver:t.data.hasReceiveOver,hasRelatedPhone:t.data.hasRelatedPhone,hasRegister:t.data.hasRegister,updatePhonedialog:!1,clickstatus:!0,receiveLogId:t.data.receiveLogId}},methods:{toClose:function(){this.updatePhonedialog=!1},toUpdateDialog:function(){this.updatePhonedialog=!0},toReceive:function(){var a=this;if(a.clickstatus){var t=/^(13|14|15|16|18|17|19)\d{9}$/,i=t.test(a.userphone);if(""==a.userphone)return void e.tips("请输入手机号码！");if(!i)return void e.tips("手机格式不正确！");a.clickstatus=!1;var s={investBillIdCode:d.param,litpic:a.data.litpic,nickname:a.data.nickname,openId:a.data.openId,phone:a.userphone,requestSource:"WAP"};$.ajax({url:"/weixin/receiveRedPacket",type:"post",dataType:"json",data:s,success:function(t){"0000"==t.code?(a.hasReceiveOver=t.data.hasReceiveOver,a.hasRelatedPhone=t.data.hasRelatedPhone,a.hasRegister=t.data.hasRegister,a.data.amount=t.data.amount,a.data.phone=t.data.phone,a.receiveUserList=t.data.receiveUserList,a.receiveLogId=t.data.receiveLogId,a.hasReceive=t.data.hasReceive,t.data.hasReceive&&e.tips("您已经领过该红包了~")):(e.tips(t.msg),a.clickstatus=!0)}})}},toUpdate:function(){var a=this;a.updatePhonedialog=!0;var t=/^(13|14|15|16|18|17|19)\d{9}$/,i=t.test(a.modifyPhone);if(""==a.modifyPhone)return void e.tips("请输入手机号码！");if(!i)return void e.tips("手机格式不正确！");var s={investBillIdCode:d.param,modifyPhone:a.modifyPhone,openId:a.data.openId,phone:a.data.phone,receiveLogId:a.receiveLogId,requestSource:"WAP"};$.ajax({url:"/weixin/modifyReceiveRelationship",type:"post",dataType:"json",data:s,success:function(t){"0000"==t.code?(a.updatePhonedialog=!1,a.data.hasRegister||(a.hasRegister=t.data.hasRegister,a.data.phone=t.data.modifyPhone)):e.tips(t.msg)}})}}}},ready:function(){var a=this;if(console.log(a.$children[0].data.recommendPicList),$("#myloading").remove(),a.$children[0].data.hasReceive&&e.tips("您已经领过该红包了~"),"ios"==localStorage.fromapp){var t={title:a.$children[0].data.shareTitle,desc:a.$children[0].data.shareContent,img:a.$children[0].data.sharePic,url:a.$children[0].data.shareUrl};window.webkit.messageHandlers.share.postMessage(t)}else if("android"==localStorage.fromapp){var t={title:a.$children[0].data.shareTitle,desc:a.$children[0].data.shareContent,img:a.$children[0].data.sharePic,url:a.$children[0].data.shareUrl};window.Android.callAndroidAction("0",JSON.stringify(t))}else i.setTitle(a.$children[0].data.shareTitle).setDesc(a.$children[0].data.shareContent).setImg(a.$children[0].data.sharePic).setUrl(a.$children[0].data.shareUrl).share()}}))}})});