define(["jumi","vue","getPara","autoHeight","api"],function(t,e,o,s,i){var n=o.get();new e({el:"body",components:{"my-register":{template:"#registerTemplate",data:function(){return{phone:"",password:"",phone_code:"",invite_phone:n.invitePhone,isShowHide:!0,isShowHideRegister:!0,setIntervalID:"",setIntervalIDVoice:""}},methods:{toShowHide:function(){var t=/^\S{0}$/,e=/^(13|14|15|16|18|17|19)\d{9}$/,o=/^(?!^[0-9]+$)(?!^[a-zA-Z]+$)[0-9A-Za-z]{6,16}$/,s=t.test(this.phone)||!e.test(this.phone),i=t.test(this.password)||!o.test(this.password);s||i?(this.isShowHide=!0,$("#getCodeButton").hide()):(this.isShowHide=!1,$("#getCodeButton").show())},toShowHideResiter:function(){var t=/^\S{0}$/,e=/^\S{4}$/,o=/^(13|14|15|16|18|17|19)\d{9}$/,s=/^(?!^[0-9]+$)(?!^[a-zA-Z]+$)[0-9A-Za-z]{6,16}$/,i=t.test(this.phone)||!o.test(this.phone),n=t.test(this.password)||!s.test(this.password),a=t.test(this.phone_code)||!e.test(this.phone_code);i||n||a?this.isShowHideRegister=!0:this.isShowHideRegister=!1},inputPhoneBlur:function(){var e=this.phone,o=/^\S{0}$/,s=/^(13|14|15|16|18|17|19)\d{9}$/;if(!o.test(e)){if(!s.test(e))return void t.tips("手机号码格式不正确！");var i={phone:this.phone};$.ajax({url:"/common/checkPhoneIsExist",type:"post",dataType:"json",data:i,success:function(t){t.result||($(".tips1").css({display:"block"}),$(".activityWrap").css({display:"block"}))}})}},sureBtn:function(){var t=this;this.phone;$(".tips1").css({display:"none"}),$(".activityWrap").css({display:"none"}),t.phone=""},inputPhoneKeyup:function(){var e=/^\S{11}$/,o=/^[0-9]*$/;return o.test(this.phone)?(e.test(this.phone)||(this.phone=this.phone.substring(0,11)),this.toShowHide(),void this.toShowHideResiter()):void t.tips("手机号码格式不正确！")},inputPasswordBlur:function(){var e=/^\S{0}$/,o=/^(?!^[0-9]+$)(?!^[a-zA-Z]+$)[0-9A-Za-z]{6,16}$/;if(!e.test(this.password))return o.test(this.password)?void 0:void t.tips("您设置的密码过于简单")},inputPasswordKeyup:function(){var t=/^\S{0}$/,e=/^\S{6,16}$/;t.test(this.password)||(e.test(this.password)||(this.password=this.password.substring(0,16)),this.toShowHide(),this.toShowHideResiter())},inputCodeKeyup:function(){var t=/^\S{0}$/,e=/^\S{4}$/;t.test(this.phone_code)||(e.test(this.phone_code)||(this.phone_code=this.phone_code.substring(0,4)),this.toShowHideResiter())},inputInvitePhone:function(){var e=this.invite_phone,o=/^\S{0}$/,s=/^(13|14|15|16|18|17|19)\d{9}$/;if(!o.test(e)){if(!s.test(e))return t.tips("手机号码格式不正确！"),void(this.invite_phone="");var i={invite_phone:this.invite_phone};$.ajax({url:"/common/validateUserIsExist",type:"post",dataType:"json",data:i,success:function(e){e.result||t.tips("邀请人不存在！")}})}},protocols:function(){var e=$("#protocolBox").children().length;e?t.alert({title:"聚米众筹用户注册服务协议",content:$("#protocolBox").html(),button:[{value:"知道了"}]}):$("#protocolBox").load("/common/protocol.html",function(){t.alert({title:"聚米众筹用户注册服务协议",content:$("#protocolBox").html(),button:[{value:"知道了"}]})})},ok:function(){var e={phone:this.phone,password:this.password,phone_code:this.phone_code,invite_phone:this.invite_phone};$.ajax({url:"/common/register",type:"post",cache:!1,dataType:"json",data:e,success:function(e){e.result?location.href="/h5/views/training/training.html":t.tips(e.errorMsg)}})},experienceNow:function(){$("body,html").animate({scrollTop:0},0)},sendVoiceCode:function(){var e=this;$.ajax({type:"post",url:"/common/sendSpeechValidation",data:{key:"register",phone:e.phone},dataType:"json",success:function(o){o.result?(e.$root.$children[0].countdown(),e.$root.$children[0].countdownVoice(),t.tips("语音验证码发送成功，请注意接收～")):1==o.flag?t.tips("验证码获取过于频繁，稍后再尝试～"):2==o.flag&&t.tips("未短信验证码，请先获取短信验证码～")}})},countdown:function(){var t=this;clearInterval(t.setIntervalID);var e=$("#getCodeButtonMask"),o=60;e.addClass("disabled"),t.setIntervalID=setInterval(function(){o--,e.html("获取验证码（"+o+"）"),0==o&&(clearInterval(t.setIntervalID),o=60,e.removeClass("disabled").html("获取验证码"),LUOCAPTCHA.reset())},1e3)},countdownVoice:function(){var t=this;clearInterval(t.setIntervalIDVoice);var e=$("#getVoiceCodeButton"),o=40;e.addClass("disabled"),t.setIntervalIDVoice=setInterval(function(){o--,e.html("发送语音验证码（"+o+"）"),0==o&&(clearInterval(t.setIntervalIDVoice),o=40,e.removeClass("disabled").html("发送语音验证码"))},1e3)}}}},ready:function(){var t=this;$("#myloading").remove(),s.setHeight(),$("#getCodeButtonBox").append($("#getCodeButton")),getResponse=function(e){$.ajax({type:"post",url:"/common/validatePicAndSendSms",data:{value:e},dataType:"json",success:function(e){e.result&&(t.$children[0].countdown(),t.$children[0].countdownVoice())}})}}})});