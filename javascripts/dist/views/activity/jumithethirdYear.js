define(["jumi","vue","weixin","isLogin","isLoginwx","dialog","newWxApi"],function(t,e,a,n,c,o,l){function r(){var t=localStorage.getItem("token"),e={token:t,requestSource:"WAP",activityType:1,openType:1};$.ajax({url:"/platformActivity/thirdAnniversary/receiveActivityReward",type:"post",dataType:"json",data:e,success:function(t){"0000"==t.code?1==t.data.isReceiveOne?$(".activitytwo-btn").attr("src","/h5/images/activity/thethirdyear/open-receivedone.png"):o({skin:"activityone",title:"提示",cancel:!1,content:"感谢"+t.data.registerYear+"年与聚米的第一次相遇，特此奉上红包"+t.data.hongbao+"元+聚米币"+t.data.coin+"个",button:[{value:"知道了",callback:function(){$(".activityone-btn").attr("src","/h5/images/activity/thethirdyear/open-receivedone.png"),window.location.href=location.href+"?time="+(new Date).getTime()}}]}).width(b).showModal():o({skin:"activityone",title:"提示",cancel:!1,content:t.msg,button:[{value:"知道了",callback:function(){}}]}).width(b).showModal()}})}function u(){var t=localStorage.getItem("token"),e={token:t,requestSource:"WAP",activityType:2,openType:1};$.ajax({url:"/platformActivity/thirdAnniversary/receiveActivityReward",type:"post",dataType:"json",data:e,success:function(t){"0000"==t.code?1==t.data.isReceiveTwo?$(".activitytwo-btn").attr("src","/h5/images/activity/thethirdyear/open-receivedone.png"):o({skin:"activitytwo",title:"提示",cancel:!1,content:"恭喜获得"+t.data.hongbao+"元投资红包，奖励已发放至您的红包账户",button:[{value:"知道了",callback:function(){$(".activitytwo-btn").attr("src","/h5/images/activity/thethirdyear/open-receivedone.png"),window.location.href=location.href+"?time="+(new Date).getTime()}}]}).width(b).showModal():o({skin:"activitytwo",title:"提示",cancel:!1,content:t.msg,button:[{value:"知道了",callback:function(){}}]}).width(b).showModal()}})}function d(){var t=localStorage.getItem("token"),e={token:t,requestSource:"WAP",activityType:3,openType:1};$.ajax({url:"/platformActivity/thirdAnniversary/receiveActivityReward",type:"post",dataType:"json",data:e,success:function(t){if("0000"==t.code){if(t.data.luckyBagNum>=0){if(t.data.cash>0)var e="恭喜您打开1个福袋获得现金"+t.data.cash+"元";else{if(!(t.data.hongbao>0))return;var e="恭喜您打开1个福袋获得红包"+t.data.hongbao+"元"}o({skin:"activitythree",title:"提示",cancel:!1,content:e,button:[{value:"知道了",callback:function(){g=!0}}]}).width(b).showModal(),t.data.luckyBagNum>0?$(".activitythree-contentInfo").html('您有<span class="aThreeluckyBagNum">'+t.data.luckyBagNum+"</span>个福袋，快去使用吧!"):$(".activitythree-contentInfo").text("暂无可用福袋，去看看其他活动吧！")}}else o({skin:"activitythree",title:"提示",cancel:!1,content:t.msg,button:[{value:"知道了",callback:function(){g=!0}}]}).width(b).showModal()}})}function p(){var t=localStorage.getItem("token"),e={token:t,requestSource:"WAP",activityType:3,openType:2};$.ajax({url:"/platformActivity/thirdAnniversary/receiveActivityReward",type:"post",dataType:"json",data:e,success:function(t){"0000"==t.code?t.data.openLuckyBagNum>=0&&o({skin:"activitythreeAll",title:"提示",cancel:!1,content:"恭喜您打开"+t.data.openLuckyBagNum+"个福袋获得现金"+t.data.cash+"元，红包"+t.data.hongbao+"元",button:[{value:"知道了",callback:function(){f=!0,w=!0,window.location.href=location.href+"?time="+(new Date).getTime()}}]}).width(b).showModal():o({skin:"activitythreeAll",title:"提示",cancel:!1,content:t.msg,button:[{value:"知道了",callback:function(){f=!0,w=!0}}]}).width(b).showModal()}})}function v(){$.ajax({url:"/platformActivity/thirdAnniversary/getLuckyBagRecord",type:"post",dataType:"json",data:k,success:function(t){if(t.data){var e="";for(i=0,len=t.data.length;i<len;i++){var a=new Date(t.data[i].createTime);Y=a.getFullYear()+"-",M=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",D=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",h=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",m=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":",s=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();var n=Y+M+D+h+m+s;if(0==t.data[i].rewardType)var c='<p class="receiveLogShow">'+n+" 获得红包"+t.data[i].rewardValue+"元</p>";else if(1==t.data[i].rewardType)var c='<p class="receiveLogShow">'+n+" 获得聚米币"+t.data[i].rewardValue+"元</p>";else{if(2!=t.data[i].rewardType)return;var c='<p class="receiveLogShow">'+n+" 获得现金"+t.data[i].rewardValue+"元</p>"}e+=c}}"0000"==t.code?e?o({skin:"receiveAThree",title:"获奖记录",cancel:!1,content:e,button:[{value:"知道了",callback:function(){}}]}).width(b).showModal():o({skin:"receiveAThree",title:"获奖记录",cancel:!1,content:"暂无获奖记录，去看看其他活动吧 ！",button:[{value:"知道了",callback:function(){}}]}).width(b).showModal():o({skin:"receiveAThree",title:"提示",cancel:!1,content:t.msg,button:[{value:"知道了",callback:function(){}}]}).width(b).showModal()}})}var y=localStorage.getItem("token"),g=!0,f=!0,w=!0,k={token:y,requestSource:"WAP"},b=.9*$(window).width();$.ajax({url:"/platformActivity/thirdAnniversary/getActivityInfo",type:"post",dataType:"json",data:k,success:function(t){"0000"==t.code&&(1==t.data.isReceiveOne?$(".activityone-btn").attr("src","/h5/images/activity/thethirdyear/open-receivedone.png"):$(".activityone-btn").click(function(){n(function(){r()})}),1==t.data.isReceiveTwo?$(".activitytwo-btn").attr("src","/h5/images/activity/thethirdyear/open-receivedone.png"):$(".activitytwo-btn").click(function(){n(function(){u()})}),$(".activitythree-btnOne").click(function(){n(function(){g&&(g=!1,d())})}),$(".activitythree-btnAll").click(function(){n(function(){f&&(f=!1,o({skin:"openActivityThreeAll",title:"提示",content:"确定打开全部福袋吗？",okValue:"确定",ok:function(){f=!0,w&&(w=!1,p())},cancelValue:"取消",cancel:function(){f=!0}}).width(b).showModal())})}),$(".award-log").click(function(){n(function(){v()})}),t.data.luckyBagNum>0?$(".activitythree-contentInfo").html('您有<span class="aThreeluckyBagNum">'+t.data.luckyBagNum+"</span>个福袋，快去使用吧!"):$(".activitythree-contentInfo").text("暂无可用福袋，去看看其他活动吧！"))}}),$(".activityone-explainEvent").click(function(){o({skin:"explainOneEvent",title:"活动说明",cancel:!1,content:"<p>1、所有投资过的用户（新手训练营及不回报本金型投资除外）均可参与；</p><p>2、每个用户只可领取1次红包；</p><p>3、红包类型为投资红包，可用于众筹项目抵扣投资额的1%；</p><p>4、红包及聚米币领取后自动存入账户，请进入个人中心查看。</p>",button:[{value:"知道了"}]}).width(b).showModal()}),$(".activitytwo-explain").click(function(){o({skin:"explainTwoEvent",title:"活动说明",cancel:!1,content:"<p>1、满足条件的回归用户，可同时参与平台其余活动；</p><p>2、投资奖励的红包将于活动结束后1个工作日内自动存入红包账户，请进入个人中心查看。</p>",button:[{value:"知道了"}]}).width(b).showModal()}),$(".activitythree-explain").click(function(){o({skin:"explainThreeEvent",title:"活动说明",cancel:!1,content:"1、福袋奖励包含现金、投资红包，中奖率100%；<p>2、奖励将在中奖后自动发入您的账户，请进入个人中心查看；</p><p>3、以上内容如有疑问，请拨打客户服务热线400-801-4680，或者添加聚米客服微信jumisec1 进行咨询；</p><p>4、在法律允许范围内，本活动最终解释权归属聚米众筹所有。</p>",button:[{value:"知道了"}]}).width(b).showModal()}),$("#myloading").remove();var A={url:decodeURIComponent(location.href.split("#")[0]),requestSource:"WAP"};$.ajax({url:"/weixin/initJs",type:"post",dataType:"json",data:A,success:function(t){"0000"==t.code&&l.config({debug:!1,appId:t.data.appId,timestamp:t.data.timestamp,nonceStr:t.data.noncestr,signature:t.data.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","chooseImage","previewImage","getNetworkType","scanQRCode","chooseWXPay"]})},error:function(){}}),l.ready(function(){var t=encodeURI("https://jumifinance.oss-cn-hangzhou.aliyuncs.com/20180403134246.jpg"),e={title:"聚米众筹成立3周年，精彩活动不容错过！",desc:"3周年庆典火热进行中，全民送福利，投资赠丰厚豪礼！",img:t,url:"/h5/views/activity/jumithethirdYear.html"},a=decodeURIComponent(location.href.split("#")[0]);a=a.split("//")[1],a=a.split("/")[0],e.url="https://"+a+e.url,l.onMenuShareAppMessage({title:e.title,desc:e.desc,link:e.url,imgUrl:"https://jumifinance.oss-cn-hangzhou.aliyuncs.com/20180403134246.jpg",type:"",dataUrl:"",success:function(){},cancel:function(){}}),l.onMenuShareTimeline({title:e.title,link:e.url,imgUrl:e.img,success:function(){},cancel:function(){}}),l.onMenuShareQQ({title:e.title,desc:e.desc,link:e.url,imgUrl:e.img,success:function(){},cancel:function(){}}),l.onMenuShareWeibo({title:e.title,desc:e.desc,link:e.url,imgUrl:e.img,success:function(){},cancel:function(){}})})});