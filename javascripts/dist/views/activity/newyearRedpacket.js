define(["jumi","vue","getPara","weixin"],function(e,a,t,r){var s=t.get(),i={code:s.code,ruleId:s.id,requestSource:"WAP"};$.ajax({url:"/activityHongbao/getReceiveResult",type:"get",dataType:"json",data:i,success:function(t){console.log("getReceiveResult"),console.log(t),"0000"==t.code?1==t.data.revResult.hasRedirect?location.href=t.data.revResult.redirectUrl:new a({el:"body",components:{"my-redpacket":{template:"#redpacketTemplate",data:function(){return{data:t.data,isRedirect:t.data.revResult.hasRedirect,redirectURL:t.data.revResult.redirectUrl,userPhone:t.data.revResult.phone,redpacketAmt:t.data.hbAmt,redpacketImg:t.data.hbImgUrl,redpacketNum:t.data.hbNumber,redpacketTitle:t.data.hbTitle,receiveUserList:t.data.revResult.revUserInfoList,userHead:t.data.revResult.userHeadImgUrl,result:t.data.revResult,saveMoney:t.data.revResult.revAmt,hasReceive:t.data.revResult.revStatus,hasRegister:t.data.revResult.hasRegister,clickstatus:!0,opening:!1,shareUserId:t.data.revResult.shareUserId,shareTitle:t.data.shareInfo.shareTitle,shareContent:t.data.shareInfo.shareContent,sharePic:t.data.shareInfo.shareImageUrl,shareUrl:t.data.shareInfo.shareLinkUrl}},computed:{sumRedpacket:function(){for(var e=this,a=0,t=0;t<e.receiveUserList.length;t++)a+=e.receiveUserList[t].revAmt;return a}},methods:{replaceUse:function(){location.replace("/h5/views/main/index.html")},replaceReg:function(){location.replace("/h5/views/account/invite/inviteFriend.html?u="+this.shareUserId)},openRedpacket:function(){var a=this,t={nickName:a.result.nickName,openId:a.result.openId,userHeadImgUrl:a.userHead,ruleId:s.id};$.ajax({url:"/activityHongbao/getHomePageData",type:"get",dataType:"json",data:t,success:function(t){console.log("getHomePageData"),console.log(t),"0000"==t.code?(a.shareUserId=t.data.revResult.shareUserId,a.userPhone=t.data.revResult.phone,a.redpacketAmt=t.data.hbAmt,a.redpacketNum=t.data.hbNumber,a.receiveUserList=t.data.revResult.revUserInfoList,a.saveMoney=t.data.revResult.revAmt,a.hasReceive=t.data.revResult.revStatus,a.hasRegister=t.data.revResult.hasRegister,$("#redCover").animate({opacity:0},300,function(){a.opening=!0})):e.tips(t.msg,3e3)}})},toReceive:function(){var a=this;if(a.clickstatus){a.clickstatus=!1;var t=/^(13|14|15|16|18|17|19)\d{9}$/,r=t.test(a.userPhone);if(""==a.userPhone)return void e.tips("请输入手机号码！");if(!r)return void e.tips("手机格式不正确！");var i={nickName:a.result.nickName,openId:a.result.openId,phone:a.userPhone,userHeadImgUrl:a.userHead,ruleId:s.id};e.alert({content:"确认关联手机号"+i.phone+"吗？",width:"90%",height:"auto",skin:"jumiaz",button:[{value:"取消",callback:function(){a.clickstatus=!0}},{value:"确定",callback:function(){a.clickstatus=!1,$.ajax({url:"/activityHongbao/handReceiveHongbao",type:"get",dataType:"json",data:i,success:function(t){a.clickstatus=!0,console.log("handReceiveHongbao"),console.log(t),"0000"==t.code?(a.shareUserId=t.data.shareUserId,a.userPhone=t.data.phone,a.result.openId=t.data.openId,a.hasReceive=t.data.revStatus,a.hasRegister=t.data.hasRegister,a.userPhone=t.data.phone,a.saveMoney=t.data.revAmt,1==a.hasReceive&&a.receiveUserList.push({userHeadImgUrl:t.data.userHeadImgUrl,nickName:t.data.nickName,revTime:t.data.revTime,revAmt:t.data.revAmt})):e.alert({content:t.msg,width:"90%",height:"auto",skin:"jumiaz",button:[{value:"确定",callback:function(){$.noop}}]})}})}}]})}}}}},ready:function(){var a=this;if($("#myloading").remove(),0==a.$children[0].hasReceive?$("title").text("聚米新年红包"):$("title").text("红包详情"),1==a.$children[0].hasReceive&&(a.$children[0].opening=!0,e.tips("您已经领过该红包了！")),"ios"==localStorage.fromapp){var t={title:a.$children[0].data.shareTitle,desc:a.$children[0].data.shareContent,img:a.$children[0].data.sharePic,url:a.$children[0].data.shareUrl};window.webkit.messageHandlers.share.postMessage(t)}else if("android"==localStorage.fromapp){var t={title:a.$children[0].data.shareTitle,desc:a.$children[0].data.shareContent,img:a.$children[0].data.sharePic,url:a.$children[0].data.shareUrl};window.Android.callAndroidAction("0",JSON.stringify(t))}else r.setTitle(a.$children[0].shareTitle).setDesc(a.$children[0].shareContent).setImg(a.$children[0].sharePic).setUrl(a.$children[0].shareUrl).share()}}):e.tips(t.msg,3e3)}})});