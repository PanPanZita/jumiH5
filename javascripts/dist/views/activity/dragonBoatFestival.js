define(["jumi","vue","getPara","isLogin","isLoginwx","weixin"],function(e,t,i,n,r,s){function o(){var o,a=i.get(),c=new RegExp(/^(13|14|15|16|18|17|19)\d{9}$/),l=localStorage.getItem("token"),d={token:l||null,requestSource:"WAP"};$.ajax({type:"get",url:"/marketing/isexchange",data:d,success:function(i){var h,u,f,v;"0000"==i.code?(h=1,u=0,f=null):"1010"==i.code?(h=0,u=0,f=null):"8019"==i.code?(h=1,u=1,f=i.data):"8015"==i.code?(v=5,h=1,u=0,f=null):"8016"==i.code?(v=6,h=1,u=0,f=null):"8017"==i.code?(v=7,h=1,u=0,f=null):e.tips(i.msg),new t({el:"body",components:{"dragon-boat":{template:"#dragonBoatTemplate",data:function(){return{loginStatuv:h,catchStatuv:u,addressList:[],orderHref:"/h5/views/account/active/activeDetail.html?orderId="+f,addressId:null,receiveAddress:null,receiveName:null,receivePhone:null,formId:null,formAddress:"",formName:"",formPhone:"",isChecked:!1,isShelter:!1,info:{addressId:null,receiveAddress:null,receiveName:null,receivePhone:null,token:l||null,requestSource:"WAP"},shareTitle:"“粽”享端午，浓情来袭",shareContent:"在此美好佳节，聚米众筹怎能少得了粽子助兴",sharePic:"https://jumifinancetest.oss-cn-hangzhou.aliyuncs.com/itemDetail/1526452426344079104.png",shareUrl:location.origin+"/h5/views/activity/dragonBoatFestival.html"}},methods:{preventDefaultz:function(e){return e.preventDefault(),!1},byeShelter:function(){this.isShelter=!1},catchZz:function(){0==this.loginStatuv?e.alert({skin:"buttonz",fixed:!0,content:"您还未登录",button:[{value:"取消"},{value:"去登录",callback:function(){n()}}]}):5==v?e.alert({skin:"buttonz",fixed:!0,content:"不在活动时间内，不能进行领取！",button:[{value:"知道了",callback:function(){}}]}):6==v?e.alert({skin:"buttonz",fixed:!0,content:"不在活动时间内，不能进行领取！",button:[{value:"知道了",callback:function(){}}]}):7==v?e.alert({skin:"buttonz",fixed:!0,content:"您的投资总额未满 2 万元",button:[{value:"知道了"},{value:"去投资",callback:function(){location.href=location.origin+"/h5/views/main/list.html?type=0&status=0&itemName="}}]}):this.isShelter=!0},chooseThis:function(e,t){this.isChecked=$(t.target).prop("checked"),this.isChecked?($(".switcher input").prop("checked",!1),$(t.target).prop("checked",!0),$(".universal-item").prop("disabled",!0),this.addressId=e.id,this.receiveName=e.userName,this.receivePhone=e.mobile,this.receiveAddress=e.province+e.city+e.address):($(".switcher input").prop("checked",!1),$(t.target).prop("checked",!1),$(".universal-item").prop("disabled",!1))},getAddressList:function(){var t=this;$.ajax({type:"post",url:"/userCenter/setting/getUserAddress",dataType:"json",data:d,success:function(i){"0000"==i.code?t.addressList=i.data.addressList:e.tips(i.msg)},error:function(e){console.error(e)}})},submitInfo:function(){if(this.isChecked)this.info.addressId=this.addressId,this.info.receiveName=this.receiveName,this.info.receivePhone=this.receivePhone,this.info.receiveAddress=this.receiveAddress,this.uploadInfo();else{if(this.info.addressId=this.formId,this.info.receiveName=this.formName,this.info.receivePhone=this.formPhone,this.info.receiveAddress=this.formAddress,!this.info.receiveName||0==this.info.receiveName.trim().length)return void e.tips("收货人姓名不能为空");if(!c.test(this.info.receivePhone))return void e.tips("收货人手机号格式不正确");if(!this.info.receiveAddress||0==this.info.receiveAddress.trim().length)return void e.tips("收货地址不能为空");this.uploadInfo()}},uploadInfo:function(){var t=this;$.ajax({type:"post",url:"/marketing/saveorder",dataType:"json",data:t.info,success:function(i){console.log(i),"0000"==i.code?(t.isShelter=!1,setTimeout(function(){t.orderId=i.data,e.alert({skin:"buttonz",fixed:!0,content:"领取成功，奖励将会在 3 个工作日内发放",button:[{value:"知道了",callback:function(){t.loginStatuv=1,t.catchStatuv=1}},{value:"查看订单",callback:function(){var e=location.origin+"/h5/views/account/active/activeDetail.html?orderId="+i.data;location.replace(e)}}]})},500)):e.tips(i.msg)},error:function(e){console.error(e)}})}},watch:{isShelter:function(){this.isShelter?o.style.overflow="hidden":o.style.overflow="initial"}}}},ready:function(){if($("#myloading").remove(),a.from){var e=location.href.split("&code=")[0],t=location.href.split("&code=")[1];if(t){var i=t.split("&state=")[0];r(i,e)}}else{var e=location.href.split("?code=")[0],t=location.href.split("?code=")[1];if(t){var i=t.split("&state=")[0];r(i,e)}}var n=this;if(1==h&&0==u&&n.$children[0].getAddressList(),o=document.getElementById("dragonBoat"),"ios"==localStorage.fromapp){var c={title:n.$children[0].shareTitle,desc:n.$children[0].shareContent,img:n.$children[0].sharePic,url:n.$children[0].shareUrl};window.webkit.messageHandlers.share.postMessage(c)}else if("android"==localStorage.fromapp){var c={title:n.$children[0].shareTitle,desc:n.$children[0].shareContent,img:n.$children[0].sharePic,url:n.$children[0].shareUrl};window.Android.callAndroidAction("0",JSON.stringify(c))}s.setTitle(n.$children[0].shareTitle).setDesc(n.$children[0].shareContent).setImg(n.$children[0].sharePic).setUrl(n.$children[0].shareUrl).share()}})},error:function(e){console.error(e)}})}navigator.userAgent.indexOf("Android")!=-1?setTimeout(function(){o()},1e3):o()});